# Exploiting Memory Hierarchy

## p4

temp locality: 
spatial locality: loop

利用現實的限制達到理想的目標: memory hierarchy

## p5

disk -> DRAM -> SRAM

讀一個 word 讀不到。到 DRAM 取 256 個 word 到 cache 內

## p6

兩層 cache 都在 CPU 中

DRAM 讀資料到第二層

## p8

1 個 cache mapping 到多個 memory

byte offset: default 2bit
word offset: 這個 block 的第幾個 word

index: 定位在 cache 的哪個位置

tag: 用 tag 區分是哪個 memory

## p18

block size 太大，占 cache 空間但沒有人 access > 浪費

e.g.

128 x 128 access 16 x 16

8 larger blocks vs 16 smaller blocks

16 快: 因為 16 block 紀錄所有 16 個 array，後面所有都 hit
8 慢: 多 load 在 window 外面的東西，但是不會用 > pollution

## p20

cache 寫完部會直接結束，會再寫到 memorey > for consistent

## p22

write miss > write memory > write cache

## p25

address (1) + 4word x 15 + 1word

## p26

bus 窄，所以送 4 次

## p30

i-cache: branch / not-branch 兩種情況，miss rate 較少

## p33

fully associative:

cache 可以同時放 256 個 block

memory 要搬到 cache 沒有限制，有空的就可以搬進去 (可以放到 cache 的任意位置)

n-way set associative:

set: block 的意思

cache 有 16 個 set，每個 set 可以放 n 個 block

memory 的 address 有一個欄位對應到 cache 的 set address

direct: 1-way set

n-way 怎麼知道 set 裡面在哪個 block: 一個 set 需要 n 個 comparator

## p41

LRU: 最近被 access 到的留下來

## p45

primary cache: hit time (較小)
L-2 cache: miss rate (較大)

## p48

B 一直換 index

## p50

一次加一個 block size

inblock miss 伴隨一堆 hit


